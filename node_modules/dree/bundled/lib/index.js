!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("dree",[],r):"object"==typeof exports?exports.dree=r():e.dree=r()}(this,(function(){return(()=>{"use strict";var e={183:function(e,r,n){var t=this&&this.__awaiter||function(e,r,n,t){return new(n||(n=Promise))((function(s,i){function o(e){try{c(t.next(e))}catch(e){i(e)}}function a(e){try{c(t.throw(e))}catch(e){i(e)}}function c(e){var r;e.done?s(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(o,a)}c((t=t.apply(e,r||[])).next())}))},s=this&&this.__generator||function(e,r){var n,t,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,t&&(s=2&i[0]?t.return:i[0]?t.throw||((s=t.return)&&s.call(t),0):t.next)&&!(s=s.call(t,i[1])).done)return s;switch(t=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,t=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=r.call(e,o)}catch(e){i=[6,e],t=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.parseTreeAsync=r.parseTree=r.parseAsync=r.parse=r.scanAsync=r.scan=r.Type=void 0;var i,o=n(622),a=n(417),c=n(747),u=n(669),l=u.promisify(c.stat),h=u.promisify(c.readdir),f=u.promisify(c.readFile),d=u.promisify(c.lstat);!function(e){e.DIRECTORY="directory",e.FILE="file"}(i=r.Type||(r.Type={}));var p={stat:!1,normalize:!1,symbolicLinks:!0,followLinks:!1,sizeInBytes:!0,size:!0,hash:!0,hashAlgorithm:"md5",hashEncoding:"hex",showHidden:!0,depth:void 0,exclude:void 0,matches:void 0,extensions:void 0,emptyDirectory:!1,excludeEmptyDirectories:!1,skipErrors:!0},y={symbolicLinks:!0,followLinks:!1,showHidden:!0,depth:void 0,exclude:void 0,extensions:void 0,skipErrors:!0};function v(e){var r={};if(e){for(var n in p)r[n]=void 0!==e[n]?e[n]:p[n];r.depth<0&&(r.depth=0)}else r=p;return r}function m(e){var r={};if(e){for(var n in y)r[n]=void 0!==e[n]?e[n]:y[n];r.depth<0&&(r.depth=0)}else r=y;return r}function x(e){var r,n=["B","KB","MB","GB","TB"];for(r=0;r<n.length&&e>1e3;r++)e/=1e3;return Math.round(100*e)/100+" "+n[r]}function E(e,r,n,t,s,u){if(void 0!==t.depth&&n>t.depth)return null;if(t.exclude&&e!==r&&(t.exclude instanceof RegExp?[t.exclude]:t.exclude).some((function(e){return e.test(r)})))return null;var l,h,f=e===r?".":o.relative(e,r),d=o.basename(r);try{l=c.statSync(r)}catch(e){if(t.skipErrors)return null;throw e}try{h=c.lstatSync(r)}catch(e){if(t.skipErrors)return null;throw e}var p,y=h.isSymbolicLink(),v=l.isFile()?i.FILE:i.DIRECTORY;if(!t.showHidden&&"."===d.charAt(0))return null;if(!t.symbolicLinks&&y)return null;if(t.hash){var m=t.hashAlgorithm;(p=a.createHash(m)).update(d)}var b={name:d,path:t.normalize?r.replace(/\\/g,"/"):r,relativePath:t.normalize?f.replace(/\\/g,"/"):f,type:v,isSymbolicLink:y,stat:t.stat?t.followLinks?l:h:void 0};switch(v){case i.DIRECTORY:var k=[],w=void 0;if(t.followLinks||!y){try{w=c.readdirSync(r)}catch(e){if(t.skipErrors)return null;throw e}if(t.emptyDirectory&&(b.isEmpty=!w.length),w.forEach((function(i){var a=E(e,o.resolve(r,i),n+1,t,s,u);null!==a&&k.push(a)})),t.excludeEmptyDirectories&&!k.length)return null}if(t.matches&&e!==r){var g=t.matches instanceof RegExp?[t.matches]:t.matches;if(!k.length&&g.some((function(e){return!e.test(r)})))return null}if(t.sizeInBytes||t.size){var L=k.reduce((function(e,r){return e+r.sizeInBytes}),0);b.sizeInBytes=L,b.size=t.size?x(L):void 0,t.sizeInBytes||k.forEach((function(e){return e.sizeInBytes=void 0}))}if(t.hash){k.forEach((function(e){p.update(e.hash)}));var I=t.hashEncoding;b.hash=p.digest(I)}k.length&&(b.children=k);break;case i.FILE:if(b.extension=o.extname(r).replace(".",""),t.extensions&&-1===t.extensions.indexOf(b.extension))return null;if(t.matches&&e!==r&&(g=t.matches instanceof RegExp?[t.matches]:t.matches).some((function(e){return!e.test(r)})))return null;if((t.sizeInBytes||t.size)&&(L=t.followLinks?l.size:h.size,b.sizeInBytes=L,b.size=t.size?x(L):void 0),t.hash){var z=void 0;try{z=c.readFileSync(r)}catch(e){if(t.skipErrors)return null;throw e}p.update(z),I=t.hashEncoding,b.hash=p.digest(I)}break;default:return null}return s&&v===i.FILE?s(b,t.followLinks?l:h):u&&v===i.DIRECTORY&&u(b,t.followLinks?l:h),b}function b(e,r,n,c,u,p){return t(this,void 0,void 0,(function(){var y,v,m,E,k,w,g,L,I,z,R,B,S,T,D,O,F,A,C,Y=this;return s(this,(function(H){switch(H.label){case 0:if(void 0!==c.depth&&n>c.depth)return[2,null];if(c.exclude&&e!==r&&(c.exclude instanceof RegExp?[c.exclude]:c.exclude).some((function(e){return e.test(r)})))return[2,null];y=e===r?".":o.relative(e,r),v=o.basename(r),H.label=1;case 1:return H.trys.push([1,3,,4]),[4,l(r)];case 2:return m=H.sent(),[3,4];case 3:if(E=H.sent(),c.skipErrors)return[2,null];throw E;case 4:return H.trys.push([4,6,,7]),[4,d(r)];case 5:return k=H.sent(),[3,7];case 6:if(w=H.sent(),c.skipErrors)return[2,null];throw w;case 7:if(g=k.isSymbolicLink(),L=m.isFile()?i.FILE:i.DIRECTORY,!c.showHidden&&"."===v.charAt(0))return[2,null];if(!c.symbolicLinks&&g)return[2,null];switch(c.hash&&(z=c.hashAlgorithm,(I=a.createHash(z)).update(v)),R={name:v,path:c.normalize?r.replace(/\\/g,"/"):r,relativePath:c.normalize?y.replace(/\\/g,"/"):y,type:L,isSymbolicLink:g,stat:c.stat?c.followLinks?m:k:void 0},L){case i.DIRECTORY:return[3,8];case i.FILE:return[3,15]}return[3,21];case 8:if(B=[],S=void 0,!c.followLinks&&g)return[3,14];H.label=9;case 9:return H.trys.push([9,11,,12]),[4,h(r)];case 10:return S=H.sent(),[3,12];case 11:if(T=H.sent(),c.skipErrors)return[2,null];throw T;case 12:return c.emptyDirectory&&(R.isEmpty=!S.length),[4,Promise.all(S.map((function(i){return t(Y,void 0,void 0,(function(){var t;return s(this,(function(s){switch(s.label){case 0:return[4,b(e,o.resolve(r,i),n+1,c,u,p)];case 1:return null!==(t=s.sent())&&B.push(t),[2]}}))}))})))];case 13:if(H.sent(),c.excludeEmptyDirectories&&!B.length)return[2,null];H.label=14;case 14:return c.matches&&e!==r&&(D=c.matches instanceof RegExp?[c.matches]:c.matches,!B.length&&D.some((function(e){return!e.test(r)})))?[2,null]:((c.sizeInBytes||c.size)&&(O=B.reduce((function(e,r){return e+r.sizeInBytes}),0),R.sizeInBytes=O,R.size=c.size?x(O):void 0,c.sizeInBytes||B.forEach((function(e){return e.sizeInBytes=void 0}))),c.hash&&(B.forEach((function(e){I.update(e.hash)})),C=c.hashEncoding,R.hash=I.digest(C)),B.length&&(R.children=B),[3,22]);case 15:if(R.extension=o.extname(r).replace(".",""),c.extensions&&-1===c.extensions.indexOf(R.extension))return[2,null];if(c.matches&&e!==r&&(D=c.matches instanceof RegExp?[c.matches]:c.matches).some((function(e){return!e.test(r)})))return[2,null];if((c.sizeInBytes||c.size)&&(O=c.followLinks?m.size:k.size,R.sizeInBytes=O,R.size=c.size?x(O):void 0),!c.hash)return[3,20];F=void 0,H.label=16;case 16:return H.trys.push([16,18,,19]),[4,f(r)];case 17:return F=H.sent(),[3,19];case 18:if(A=H.sent(),c.skipErrors)return[2,null];throw A;case 19:I.update(F),C=c.hashEncoding,R.hash=I.digest(C),H.label=20;case 20:return[3,22];case 21:return[2,null];case 22:return u&&L===i.FILE?u(R,c.followLinks?m:k):p&&L===i.DIRECTORY&&p(R,c.followLinks?m:k),[2,R]}}))}))}function k(e,r,n){return!r.symbolicLinks&&e.isSymbolicLink||!r.showHidden&&"."===e.name.charAt(0)||void 0!==r.extensions&&e.type===i.FILE&&-1===r.extensions.indexOf(e.extension)||r.exclude instanceof RegExp&&r.exclude.test(e.path)||Array.isArray(r.exclude)&&r.exclude.some((function(r){return r.test(e.path)}))||void 0!==r.depth&&n>r.depth}function w(e,r,n,t){var s="";return e.map((function(s,a){var u="";if(void 0!==n.depth&&t>n.depth)return"";if(n.exclude&&(n.exclude instanceof RegExp?[n.exclude]:n.exclude).some((function(e){return e.test(s)})))return"";var l,h,f=o.basename(s);try{l=c.statSync(s)}catch(e){if(n.skipErrors)return null;throw e}try{h=c.lstatSync(s)}catch(e){if(n.skipErrors)return null;throw e}var d=h.isSymbolicLink(),p=l.isFile()?i.FILE:i.DIRECTORY;if(!n.showHidden&&"."===f.charAt(0))return"";if(!n.symbolicLinks&&d)return"";var y=o.extname(s).replace(".","");if(n.extensions&&p===i.FILE&&-1===n.extensions.indexOf(y))return"";var v=d?">>":p===i.DIRECTORY?"─> ":"── ",m=r+(a===e.length-1?"    ":"│   ");if(u+=v+f,(n.followLinks||!d)&&p===i.DIRECTORY){var x;try{x=c.readdirSync(s).map((function(e){return o.resolve(s,e)}))}catch(e){if(n.skipErrors)return null;throw e}u+=x.length?w(x,m,n,t+1):""}return u})).filter((function(e){return!!e})).forEach((function(e,n,t){s+=r+(n===t.length-1?"└"+e:"├"+e)})),s}function g(e,r,n,a){return t(this,void 0,void 0,(function(){var c,u=this;return s(this,(function(f){switch(f.label){case 0:return c="",[4,Promise.all(e.map((function(c,f){return t(u,void 0,void 0,(function(){var t,u,p,y,v,m,x,E,b,k,w,L,I,z,R;return s(this,(function(s){switch(s.label){case 0:if(t="",void 0!==n.depth&&a>n.depth)return[2,""];if(n.exclude&&(n.exclude instanceof RegExp?[n.exclude]:n.exclude).some((function(e){return e.test(c)})))return[2,""];u=o.basename(c),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,l(c)];case 2:return p=s.sent(),[3,4];case 3:if(y=s.sent(),n.skipErrors)return[2,null];throw y;case 4:return s.trys.push([4,6,,7]),[4,d(c)];case 5:return v=s.sent(),[3,7];case 6:if(m=s.sent(),n.skipErrors)return[2,null];throw m;case 7:if(x=v.isSymbolicLink(),E=p.isFile()?i.FILE:i.DIRECTORY,!n.showHidden&&"."===u.charAt(0))return[2,""];if(!n.symbolicLinks&&x)return[2,""];if(b=o.extname(c).replace(".",""),n.extensions&&E===i.FILE&&-1===n.extensions.indexOf(b))return[2,""];if(k=x?">>":E===i.DIRECTORY?"─> ":"── ",w=r+(f===e.length-1?"    ":"│   "),t+=k+u,!n.followLinks&&x||E!==i.DIRECTORY)return[3,15];s.label=8;case 8:return s.trys.push([8,10,,11]),[4,h(c)];case 9:return L=s.sent().map((function(e){return o.resolve(c,e)})),[3,11];case 10:if(I=s.sent(),n.skipErrors)return[2,null];throw I;case 11:return z=t,L.length?[4,g(L,w,n,a+1)]:[3,13];case 12:return R=s.sent(),[3,14];case 13:R="",s.label=14;case 14:t=z+R,s.label=15;case 15:return[2,t]}}))}))})))];case 1:return f.sent().filter((function(e){return!!e})).forEach((function(e,n,t){c+=r+(n===t.length-1?"└"+e:"├"+e)})),[2,c]}}))}))}function L(e,r,n,t){var s="";return e.filter((function(e){return!k(e,n,t)})).forEach((function(e,o,a){var c=e.isSymbolicLink?">>":e.type===i.DIRECTORY?"─> ":"── ",u=o===a.length-1?"└"+c:"├"+c,l=r+(o===a.length-1?"    ":"│   ");s+=r+u+e.name,s+=!e.children||!n.followLinks&&e.isSymbolicLink?"":L(e.children,l,n,t+1)})),s}function I(e,r,n,o){return t(this,void 0,void 0,(function(){var t,a,c,u,l,h,f,d,p;return s(this,(function(s){switch(s.label){case 0:t="",a=e.filter((function(e){return!k(e,n,o)})),c=0,s.label=1;case 1:return c<a.length?(u=a[c],l=u.isSymbolicLink?">>":u.type===i.DIRECTORY?"─> ":"── ",h=c===a.length-1?"└"+l:"├"+l,f=r+(c===a.length-1?"    ":"│   "),t+=r+h+u.name,d=t,!u.children||!n.followLinks&&u.isSymbolicLink?[3,3]:[4,I(u.children,f,n,o+1)]):[3,6];case 2:return p=s.sent(),[3,4];case 3:p="",s.label=4;case 4:t=d+p,s.label=5;case 5:return c++,[3,1];case 6:return[2,t]}}))}))}r.scan=function(e,r,n,t){var s=o.resolve(e),i=v(r),a=E(s,s,0,i,n,t);return a&&(a.sizeInBytes=i.sizeInBytes?a.sizeInBytes:void 0),a},r.scanAsync=function(e,r,n,i){return t(this,void 0,void 0,(function(){var t,a,c;return s(this,(function(s){switch(s.label){case 0:return t=o.resolve(e),a=v(r),[4,b(t,t,0,a,n,i)];case 1:return(c=s.sent())&&(c.sizeInBytes=a.sizeInBytes?c.sizeInBytes:void 0),[2,c]}}))}))},r.parse=function(e,r){var n,t,s="",i=o.resolve(e),a=m(r);s+=o.basename(i);try{n=c.statSync(e)}catch(e){if(r.skipErrors)return null;throw e}try{t=c.lstatSync(e)}catch(e){if(r.skipErrors)return null;throw e}var u=t.isSymbolicLink();if((a.followLinks||!u)&&n.isDirectory()){var l=void 0;try{l=c.readdirSync(i).map((function(e){return o.resolve(i,e)}))}catch(e){if(r.skipErrors)return null;throw e}s+=l.length?w(l,"\n ",a,1):""}return s},r.parseAsync=function(e,r){return t(this,void 0,void 0,(function(){var n,t,i,a,c,u,f,p,y,v,x,E,b;return s(this,(function(s){switch(s.label){case 0:n="",t=o.resolve(e),i=m(r),a=o.basename(t),n+=a,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,l(e)];case 2:return c=s.sent(),[3,4];case 3:if(u=s.sent(),r.skipErrors)return[2,null];throw u;case 4:return s.trys.push([4,6,,7]),[4,d(e)];case 5:return f=s.sent(),[3,7];case 6:if(p=s.sent(),r.skipErrors)return[2,null];throw p;case 7:if(y=f.isSymbolicLink(),!i.followLinks&&y||!c.isDirectory())return[3,15];v=void 0,s.label=8;case 8:return s.trys.push([8,10,,11]),[4,h(t)];case 9:return v=s.sent().map((function(e){return o.resolve(t,e)})),[3,11];case 10:if(x=s.sent(),r.skipErrors)return[2,null];throw x;case 11:return E=n,v.length?[4,g(v,"\n ",i,1)]:[3,13];case 12:return b=s.sent(),[3,14];case 13:b="",s.label=14;case 14:n=E+b,s.label=15;case 15:return[2,n]}}))}))},r.parseTree=function(e,r){var n="",t=m(r);return(n+=e?e.name:"")+(e.children?L(e.children,"\n ",t,1):"")},r.parseTreeAsync=function(e,r){return t(this,void 0,void 0,(function(){var n,t,i,o;return s(this,(function(s){switch(s.label){case 0:return n="",t=m(r),n+=e?e.name:"",i=n,e.children?[4,I(e.children,"\n ",t,1)]:[3,2];case 1:return o=s.sent(),[3,3];case 2:o="",s.label=3;case 3:return[2,n=i+o]}}))}))}},417:e=>{e.exports=require("crypto")},747:e=>{e.exports=require("fs")},622:e=>{e.exports=require("path")},669:e=>{e.exports=require("util")}},r={};return function n(t){if(r[t])return r[t].exports;var s=r[t]={exports:{}};return e[t].call(s.exports,s,s.exports,n),s.exports}(183)})()}));